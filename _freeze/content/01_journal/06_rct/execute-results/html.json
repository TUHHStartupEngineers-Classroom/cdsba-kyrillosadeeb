{
  "hash": "72ee2cdd9c6863a970580e27719332cd",
  "result": {
    "markdown": "---\ntitle: \"Randomized Controlled Trials\"\n---\n\n\n# Assignment 8\n\n## 1. Checking whether covariates are balanced throughout the groups.\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-1_df5afa669151e8ba6e8fed017a15f2e9'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.3     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.2     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nabtest <- readRDS(\"~/Documents/TUHH/Casual Data Science for Business Analytics/Causal_Data_Science_Data/abtest_online.rds\")\n\ncompare <- \n  ggplot(abtest, \n         aes(x = chatbot, \n             y = purchase_amount, \n             color = as.factor(chatbot))) +\n  stat_summary(geom = \"errorbar\", \n               width = .5,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = NULL, y = \"Purchase Amount\", title = \"Difference in Purchase Amount\")\n\ncompare\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nAs we can see in the plot the covariates are not balanced.\n\n## 2. Chatbot effect on sales\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-2_094bec144e4ea9af9add86cc4c4704ef'}\n\n```{.r .cell-code}\nlm_sales <- lm(purchase_amount ~ chatbot, data = abtest)\nsummary(lm_sales)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot, data = abtest)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -16.702 -14.478  -9.626  13.922  64.648 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  16.7017     0.8374  19.944  < 2e-16 ***\n#> chatbotTRUE  -7.0756     1.1796  -5.998 2.79e-09 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.65 on 998 degrees of freedom\n#> Multiple R-squared:  0.0348,\tAdjusted R-squared:  0.03383 \n#> F-statistic: 35.98 on 1 and 998 DF,  p-value: 2.787e-09\n```\n:::\n:::\n\n\nThe coefficient is a negative number telling us that the chatbots are affecting the sales in a negative way decreasing the sales and not increasing them.\n\n\n## 3. CATE taking into consideration mobile users\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-3_af34dc0588e8a4a35a7253ca3835ff12'}\n\n```{.r .cell-code}\nlm_sales_plus_mob <- lm(purchase_amount ~ chatbot*mobile_device, data = abtest)\nsummary(lm_sales_plus_mob)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot * mobile_device, data = abtest)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#> -16.98 -14.54  -9.95  14.13  65.24 \n#> \n#> Coefficients:\n#>                               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                    16.9797     1.0152  16.725   <2e-16 ***\n#> chatbotTRUE                    -7.0301     1.4284  -4.922    1e-06 ***\n#> mobile_deviceTRUE              -0.8727     1.7987  -0.485    0.628    \n#> chatbotTRUE:mobile_deviceTRUE  -0.1526     2.5369  -0.060    0.952    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.66 on 996 degrees of freedom\n#> Multiple R-squared:  0.03534,\tAdjusted R-squared:  0.03244 \n#> F-statistic: 12.16 on 3 and 996 DF,  p-value: 8.034e-08\n```\n:::\n:::\n\n\n## 4. Logistic regression for **purchase**\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-4_60fbb65988f78a497f7537381d73519f'}\n\n```{.r .cell-code}\nglm_sales <- glm(purchase ~ chatbot, family = binomial(link = 'logit'), abtest)\nsummary(glm_sales)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> glm(formula = purchase ~ chatbot, family = binomial(link = \"logit\"), \n#>     data = abtest)\n#> \n#> Coefficients:\n#>             Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept) -0.01613    0.08981  -0.180    0.857    \n#> chatbotTRUE -0.98939    0.13484  -7.337 2.18e-13 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 1329.1  on 999  degrees of freedom\n#> Residual deviance: 1273.3  on 998  degrees of freedom\n#> AIC: 1277.3\n#> \n#> Number of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n\nIn logistic regression we don't just look at the coefficient but its exponent and that tells us the \"odds ratio\" which is the ratio of the probability of an event happening divided by the probability of the non event. \n\nSince the coefficient here is a negative number hence the odds ratio is less than one and that tells us that the event will most likely not happen.\n\nIn our case the event is the purchase and so the regression tells us that having the chatbot means that the probability of the customer making a purchase is less than that when the customer doesn't have a chat bot. This means that the chat bot is negatively affecting the number of purchases and hence decreasing the sales.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}